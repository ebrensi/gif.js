#!/usr/bin/env bash

URL="https://github.com/jnordberg/gif.js"
TMP="./dist/tmp"

if [ -d ./node_modules ]; then
  PATH="./node_modules/.bin/:$PATH"
  VERSION=`./bin/version`
  echo "Packaging gif.js $VERSION"
  wa compile src/NeuQuant.c -O --out src/NeuQuant.wasm
  browserify -d -s GIF -t coffeeify src/gif.coffee | exorcist dist/gif.js.map > dist/gif.js
  browserify -d -t coffeeify -t brfs src/gif.worker.coffee | exorcist dist/gif.worker.js.map > dist/gif.worker.js

else
  echo "Build dependencies missing. Run npm install"
  exit 1
fi
